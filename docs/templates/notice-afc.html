<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FCA §§241-249 - AFC Duties - Notice of Non-Compliance - Attorney for Child">
    <title>Notice of Non-Compliance - Attorney for Child | Procedural Compliance Framework</title>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚖️</text></svg>">

    <!-- USWDS Public Sans Font -->
    <link rel="preload" href="../fonts/public-sans/PublicSans-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="../fonts/public-sans/PublicSans-SemiBold.woff2" as="font" type="font/woff2" crossorigin>

    <!-- Social Preview Meta Tags -->
    <meta property="og:title" content="Notice of Non-Compliance - Attorney for Child">
    <meta property="og:description" content="FCA §§241-249 - AFC Duties">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://proceduralcompliance.org/templates/notice-afc.html">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                container: {
                    center: true,
                    padding: '1rem',
                    screens: {
                        sm: '1100px',
                        md: '1100px',
                        lg: '1100px',
                        xl: '1100px',
                        '2xl': '1100px'
                    }
                },
                extend: {
                    colors: {
                        border: '#dfe1e2',
                        input: '#dfe1e2',
                        ring: '#005EA2',
                        background: '#ffffff',
                        foreground: '#1b1b1b',
                        primary: {
                            DEFAULT: '#005EA2',
                            foreground: '#ffffff'
                        },
                        secondary: {
                            DEFAULT: '#f9fafb',
                            foreground: '#1a1a1a'
                        },
                        muted: {
                            DEFAULT: '#f9fafb',
                            foreground: '#6b7280'
                        },
                        accent: {
                            DEFAULT: '#b8860b',
                            foreground: '#ffffff'
                        }
                    },
                    fontFamily: {
                        serif: ['Georgia', 'Cambria', 'Times New Roman', 'serif'],
                        sans: ['Public Sans', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],
                        mono: ['Monaco', 'Courier New', 'monospace']
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="../styles.css">
</head>
<body class="bg-background text-foreground font-sans antialiased">
    <!-- Skip Navigation Link -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-foreground focus:rounded focus:outline-none focus:ring-4 focus:ring-ring focus:ring-offset-2">
        Skip to main content
    </a>

    <!-- US Government-Style Banner -->
    <section class="gov-banner" role="region" aria-label="Official government-style notice">
        <div class="container mx-auto px-4 py-2">
            <div class="flex items-center gap-2">
                <img src="../us_flag_small.png" class="gov-banner-flag" alt="U.S. flag" loading="eager">
                <p class="gov-banner-text">An open framework for documenting procedural compliance · Not legal advice</p>
            </div>
        </div>
    </section>

    <!-- Header -->
    <header class="w-full border-b border-border bg-background" role="banner">
        <div class="container mx-auto px-4 py-3">
            <div class="flex flex-col md:flex-row md:h-14 md:items-center md:justify-between gap-3 md:gap-0">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <span class="text-xl" role="img" aria-label="Scales of justice">⚖️</span>
                        <h1 class="text-lg font-sans font-semibold">
                            <a href="../index.html" class="hover:text-primary transition-colors">Procedural Compliance Framework</a>
                        </h1>
                    </div>
                    <nav class="hidden md:flex items-center space-x-6 text-sm ml-8">
                        <a href="../index.html#templates" class="text-foreground/80 hover:text-foreground transition-colors">Templates</a>
                        <a href="https://github.com/josephfusco/procedural-compliance" target="_blank" rel="noopener noreferrer" class="text-foreground/80 hover:text-foreground transition-colors">GitHub</a>
                    </nav>
                </div>
                <div class="flex items-center gap-2">
                    <button id="theme-toggle" class="flex items-center justify-center px-4 py-2 text-sm font-medium text-foreground bg-transparent rounded border-2 border-border hover:bg-muted transition-colors focus:outline-none focus:ring-4 focus:ring-ring focus:ring-offset-2" aria-label="Light mode. Click to toggle" role="switch" aria-checked="false">
                        <span id="theme-label">Light</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Breadcrumb Navigation -->
    <nav class="border-b border-border bg-muted/30" aria-label="Breadcrumb">
        <div class="container mx-auto px-4 py-3">
            <ol class="flex items-center space-x-2 text-sm">
                <li><a href="../index.html" class="text-foreground/60 hover:text-foreground transition-colors">Home</a></li>
                <li class="text-foreground/40">/</li>
                <li><a href="../index.html#templates" class="text-foreground/60 hover:text-foreground transition-colors">Templates</a></li>
                <li class="text-foreground/40">/</li>
                <li class="text-foreground font-medium" aria-current="page">Notice of Non-Compliance - Attorney for Child</li>
            </ol>
        </div>
    </nav>

    <main id="main-content" role="main">
        <!-- Template Header -->
        <div class="border-b border-border bg-muted/30">
            <div class="container mx-auto px-4 py-8">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex-1">
                        <div class="flex items-center gap-3 mb-3">
                            <span class="badge badge-ny">NY</span>
                            <h1 class="text-3xl font-sans font-semibold text-foreground">Notice of Non-Compliance - Attorney for Child</h1>
                        </div>
                        <p class="text-base text-muted-foreground">FCA §§241-249 - AFC Duties</p>
                    </div>
                    <div class="flex gap-2">
                        <a href="https://github.com/josephfusco/procedural-compliance/blob/main/templates/notice_afc.md" target="_blank" rel="noopener noreferrer" class="px-4 py-2 text-sm font-medium text-foreground bg-transparent rounded border-2 border-border hover:bg-muted transition-colors focus:outline-none focus:ring-4 focus:ring-ring focus:ring-offset-2">
                            Edit on GitHub
                        </a>
                        <a href="../templates/notice_afc.md" download class="px-4 py-2 text-sm font-medium text-primary-foreground bg-primary rounded border-2 border-primary hover:bg-primary/90 transition-colors focus:outline-none focus:ring-4 focus:ring-ring focus:ring-offset-2">
                            Download
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template Content with Sidebar -->
        <div class="container mx-auto px-4 py-12">
            <div class="docs-layout">
                <!-- Table of Contents Sidebar -->
                <aside class="docs-sidebar" aria-label="Table of contents">
                    <nav class="docs-toc" id="docs-toc">
                        <h4>On This Page</h4>
                        <ul class="docs-toc-list" id="docs-toc-list">
                            <!-- Auto-populated by JavaScript -->
                        </ul>
                    </nav>
                </aside>

                <!-- Main Content -->
                <div class="docs-content">
                    <div class="prose prose-slate" id="template-content">
                        <hr>
<p><strong>JURISDICTION: NEW YORK</strong></p>
<h2>This template applies to New York State courts (Supreme, Family, Appellate Division) governed by CPLR, DRL, FCA, and 22 NYCRR.</h2>
<h1>NOTICE OF NON-COMPLIANCE — ATTORNEY FOR THE CHILD</h1>
<p><strong>[NY][FCA] Demand for Zealous Representation and Communication</strong></p>
<hr>

<div class="usa-alert usa-alert--warning">
    <div class="usa-alert__body">
        <h3 class="usa-alert__heading">
            <span class="usa-alert__icon">⚠️</span>
            Before Using This Template
        </h3>
        <div class="usa-alert__text">
            

        </div>
    </div>
</div>
<div class="usa-accordion">
    <div class="usa-accordion__item">
        <button
            class="usa-accordion__button"
            aria-expanded="true"
            aria-controls="accordion-0"
            onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'); document.getElementById('accordion-0').setAttribute('aria-hidden', this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');"
        >
            When to Use Notice to Attorney for the Child
        </button>
        <div
            id="accordion-0"
            class="usa-accordion__content"
            aria-hidden="false"
        >
            <div class="usa-accordion__content-inner">
                
<p><strong>USE this template when:</strong></p>
<ul>
<li>AFC has not met with the child they represent despite reasonable time passing</li>
<li>AFC has not filed position statements or communicated child&#39;s wishes to court</li>
<li>AFC missed court appearances or failed to participate in proceedings</li>
<li>AFC appears to be acting as law guardian (best interests) when appointed as AFC (expressed wishes)</li>
<li>You need to create record of AFC&#39;s failure to fulfill statutory duties</li>
</ul>
<p><strong>DO NOT use this if:</strong></p>
<ul>
<li>AFC is fulfilling duties but you disagree with child&#39;s expressed position</li>
<li>AFC is properly advocating for child&#39;s best interests when role is law guardian</li>
<li>This is first instance of concern (try informal communication first)</li>
<li>Child is unable to express wishes and AFC appropriately switched to best interests standard</li>
<li>AFC&#39;s strategy differs from yours but is within professional judgment</li>
</ul>
<p><strong>Appropriate example:</strong> AFC appointed 4 months ago; no documented meeting with child; no position statement filed; missed last two hearings.</p>
<p><strong>Inappropriate example:</strong> AFC is advocating for child&#39;s wish to stay with non-custodial parent and you disagree with that outcome.</p>

            </div>
        </div>
    </div>
</div>
<div class="usa-accordion">
    <div class="usa-accordion__item">
        <button
            class="usa-accordion__button"
            aria-expanded="false"
            aria-controls="accordion-1"
            onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'); document.getElementById('accordion-1').setAttribute('aria-hidden', this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');"
        >
            Try These Steps First
        </button>
        <div
            id="accordion-1"
            class="usa-accordion__content"
            aria-hidden="true"
        >
            <div class="usa-accordion__content-inner">
                
<p><strong>Before sending this notice:</strong></p>
<ol>
<li><strong>Review appointment order</strong> to confirm role (AFC vs. law guardian)</li>
<li><strong>Contact AFC directly</strong> via email/phone expressing concerns</li>
<li><strong>Ask child</strong> if AFC has met with them or explained role</li>
<li><strong>Document failures</strong> (missed appearances, lack of filings, no communication)</li>
<li><strong>Raise issue in court</strong> at next appearance before sending formal notice</li>
<li><strong>Consult FCA §§241-249</strong> to confirm actual violation of duties</li>
</ol>
<p><strong>Document everything:</strong> Court dates, attempted contacts, child&#39;s statements about meetings.</p>

            </div>
        </div>
    </div>
</div>
<div class="usa-accordion">
    <div class="usa-accordion__item">
        <button
            class="usa-accordion__button"
            aria-expanded="false"
            aria-controls="accordion-2"
            onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'); document.getElementById('accordion-2').setAttribute('aria-hidden', this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');"
        >
            Resource Requirements &amp; Consequences
        </button>
        <div
            id="accordion-2"
            class="usa-accordion__content"
            aria-hidden="true"
        >
            <div class="usa-accordion__content-inner">
                
<p>⚠️ <strong>Important Considerations:</strong></p>
<ul>
<li><strong>Timeline:</strong> AFC may respond within days; court may address at next appearance</li>
<li><strong>Child impact:</strong> May affect child&#39;s case if AFC remains ineffective</li>
<li><strong>Relationship:</strong> May damage cooperation between parties and AFC</li>
<li><strong>Court discretion:</strong> Judge may or may not remove/replace AFC based on this notice</li>
<li><strong>What this achieves:</strong> Creates record for appeal; may prompt AFC to fulfill duties; supports motion to replace</li>
<li><strong>What this does NOT do:</strong> Automatically remove AFC; guarantee new counsel; change child&#39;s expressed wishes</li>
</ul>
<p><strong>Alternatives to consider:</strong></p>
<ul>
<li><strong>Raise directly in court:</strong> Ask judge to inquire about AFC&#39;s compliance at next appearance</li>
<li><strong>Motion to replace counsel:</strong> If AFC abandonment is clear and ongoing</li>
<li><strong>Grievance complaint:</strong> For serious misconduct (use Attorney Grievance template)</li>
<li><strong>Consult with your attorney:</strong> If you&#39;re represented, have them address with court</li>
</ul>
<p><strong>Best practice:</strong> Use this after informal attempts fail and AFC&#39;s non-compliance is documented and ongoing; preserves record for appeal and supports motion to replace if needed.</p>
<hr>
<p><strong>TO:</strong> {{AFC Name}}, Esq., Attorney for the Child
<strong>FROM:</strong> {{Your Name}}, {{Party / Pro Se Litigant}}
<strong>DATE:</strong> {{Date}}
<strong>CASE:</strong> {{Caption}} | Docket No. {{Number}}
<strong>COURT:</strong> {{Family Court, County}}
<strong>SUBJECT:</strong> Notice of Non-Compliance with Duties Under FCA and NYCRR Part 7</p>
<hr>

            </div>
        </div>
    </div>
</div><h2>Legal Authority</h2>
<p>You are bound by:</p>
<ul>
<li><strong>FCA §§241–249:</strong> Duties of law guardians and attorneys for children</li>
<li><strong>22 NYCRR §7.2(d):</strong> Standards for representation of children</li>
<li><strong>RPC 1.1, 1.3, 1.4:</strong> Competence, diligence, and client communication</li>
<li><strong>Matter of Lashonda B., 28 N.Y.3d 259 (2016):</strong> AFC must zealously advocate for child&#39;s expressed wishes</li>
</ul>
<h2>Identified Deficiencies</h2>
<p>As of {{date}}, you have failed to:</p>
<ol>
<li><strong>Meet with your client:</strong> No documented contact with {{Child Name}} since {{date or &quot;case assignment&quot;}}.</li>
<li><strong>Investigate the case:</strong> No apparent review of {{documents, witnesses, evidence}}.</li>
<li><strong>Communicate position:</strong> No position statement or filing indicating {{Child Name}}&#39;s expressed wishes or best interests.</li>
<li><strong>Appear at proceedings:</strong> Failed to appear at {{hearing date/description}}.</li>
<li>{{Additional deficiencies as applicable}}</li>
</ol>
<h2>Demand</h2>
<p>You are demanded to:</p>
<ol>
<li><strong>Meet with {{Child Name}}</strong> within {{X}} business days and document the meeting.</li>
<li><strong>File a position statement</strong> reflecting your client&#39;s expressed wishes or, if applicable, your substituted judgment with explanation.</li>
<li><strong>Provide written confirmation</strong> of compliance to all parties within the same timeframe.</li>
</ol>
<h2>Preservation and Remedy</h2>
<p>This notice preserves the record for:</p>
<ul>
<li>Motion to disqualify or replace counsel</li>
<li>Appellate review of ineffective assistance</li>
<li>Administrative complaint under 22 NYCRR Part 1240 (Attorney Grievance)</li>
</ul>
<p>Failure to comply may result in a motion for your removal and appointment of substitute counsel.</p>
<h2>Service</h2>
<p>Served via {{email / certified mail / NYSCEF}} on {{date}}.</p>
<hr>
<p><strong>Certification of Service</strong></p>
<p>I certify that this Notice of Non-Compliance was served upon {{AFC Name}} via {{method}} on {{date}}.</p>
<p>{{Your Signature}}
{{Your Name}}
{{Address}}
{{Phone}}
{{Email}}</p>

                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t-2 border-border bg-muted/30 py-12 mt-8" role="contentinfo">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-10">
                <div>
                    <h3 class="text-lg font-sans font-semibold mb-4 text-foreground">Open Collaboration</h3>
                    <p class="helpful-text text-sm mb-3 leading-relaxed">An open specification for verifying adherence to statutory procedure in state and federal courts. Contributions welcome.</p>
                    <p class="helpful-text text-sm font-medium"><strong>Not legal advice.</strong> Educational purposes only.</p>
                </div>

                <div>
                    <h3 class="text-lg font-sans font-semibold mb-4 text-foreground">Resources</h3>
                    <ul class="space-y-3 text-sm">
                        <li><a href="https://github.com/josephfusco/procedural-compliance" target="_blank" rel="noopener noreferrer" class="footer-link text-foreground/80 hover:text-foreground transition-colors underline decoration-1 underline-offset-2">GitHub Repository</a></li>
                        <li><a href="https://github.com/josephfusco/procedural-compliance/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer-link text-foreground/80 hover:text-foreground transition-colors underline decoration-1 underline-offset-2">Contributing Guide</a></li>
                        <li><a href="https://github.com/josephfusco/procedural-compliance/issues" target="_blank" rel="noopener noreferrer" class="footer-link text-foreground/80 hover:text-foreground transition-colors underline decoration-1 underline-offset-2">Report Issue</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="text-lg font-sans font-semibold mb-4 text-foreground">Legal</h3>
                    <ul class="space-y-3 text-sm">
                        <li><a href="https://github.com/josephfusco/procedural-compliance/blob/main/LICENSE" target="_blank" rel="noopener noreferrer" class="footer-link text-foreground/80 hover:text-foreground transition-colors underline decoration-1 underline-offset-2">MIT License</a></li>
                    </ul>
                </div>

                <div>
                    <div class="flex items-center gap-2 mb-4">
                        <span class="badge badge-ny">NY</span>
                        <h3 class="text-lg font-sans font-semibold text-foreground">NY Court Resources</h3>
                    </div>
                    <ul class="space-y-3 text-sm">
                        <li><a href="https://www.nycourts.gov/efile/rules.shtml" target="_blank" rel="noopener noreferrer" class="footer-link text-foreground/80 hover:text-foreground transition-colors underline decoration-1 underline-offset-2">NYSCEF E-Filing Rules</a></li>
                        <li><a href="https://ww2.nycourts.gov/courts/index.shtml" target="_blank" rel="noopener noreferrer" class="footer-link text-foreground/80 hover:text-foreground transition-colors underline decoration-1 underline-offset-2">NY Court Directory</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t-2 border-border pt-8 text-center">
                <p class="text-sm text-foreground/70 font-medium">&copy; 2025 Procedural Compliance Framework (PCF)</p>
                <p class="text-sm text-foreground/70 mt-2">Released under MIT License • Open Source Legal Framework</p>
                <p class="text-xs text-foreground/60 mt-3">Accessibility: WCAG 2.1 AA • ADA Title II § 35.160 • Section 508 Standards</p>
            </div>
        </div>
    </footer>

    <!-- Theme Toggle Script -->
    <script>
        (function() {
            const THEMES = { LIGHT: 'light', DARK: 'dark' };
            const LABELS = { light: 'Light', dark: 'Dark' };
            const ARIA_LABELS = {
                light: 'Light mode. Click to switch to dark mode',
                dark: 'Dark mode. Click to switch to light mode'
            };

            const themeToggle = document.getElementById('theme-toggle');
            const themeLabel = document.getElementById('theme-label');
            const html = document.documentElement;

            function getSavedTheme() {
                return localStorage.getItem('theme') || THEMES.LIGHT;
            }

            function applyTheme(theme) {
                html.setAttribute('data-theme', theme);
                themeLabel.textContent = LABELS[theme];
                themeToggle.setAttribute('aria-checked', theme === THEMES.DARK ? 'true' : 'false');
                themeToggle.setAttribute('aria-label', ARIA_LABELS[theme]);
            }

            function toggleTheme() {
                const currentTheme = getSavedTheme();
                const nextTheme = currentTheme === THEMES.LIGHT ? THEMES.DARK : THEMES.LIGHT;
                localStorage.setItem('theme', nextTheme);
                applyTheme(nextTheme);
            }

            applyTheme(getSavedTheme());
            themeToggle.addEventListener('click', toggleTheme);
            themeToggle.addEventListener('keydown', (e) => {
                if (e.key === ' ' || e.key === 'Enter') {
                    e.preventDefault();
                    toggleTheme();
                }
            });
        })();
    </script>

    <!-- Template Content Enhancements -->
    <script>
        // Separate metadata from document
        const content = document.getElementById('template-content');
        if (content) {
            // Highlight placeholders
            const walker = document.createTreeWalker(content, NodeFilter.SHOW_TEXT, null);
            const nodesToReplace = [];
            while (walker.nextNode()) {
                const node = walker.currentNode;
                if (node.textContent.includes('{{') && node.textContent.includes('}}')) {
                    nodesToReplace.push(node);
                }
            }

            nodesToReplace.forEach(node => {
                const fragment = document.createDocumentFragment();
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = node.textContent.replace(
                    /\{\{([^}]+)\}\}/g,
                    '<span class="template-placeholder">{{$1}}</span>'
                );
                while (tempDiv.firstChild) {
                    fragment.appendChild(tempDiv.firstChild);
                }
                node.parentNode.replaceChild(fragment, node);
            });
        }
    </script>

    <!-- Table of Contents Generation & Scroll Spy -->
    <script>
        (function() {
            const content = document.getElementById('template-content');
            const tocList = document.getElementById('docs-toc-list');

            if (!content || !tocList) return;

            // Generate slug from heading text
            function generateSlug(text) {
                return text
                    .toLowerCase()
                    .replace(/[^a-z0-9]+/g, '-')
                    .replace(/^-+|-+$/g, '');
            }

            // Find all H2 and H3 headings
            const headings = content.querySelectorAll('h2, h3');
            const tocItems = [];

            headings.forEach((heading, index) => {
                const level = heading.tagName.toLowerCase();
                const text = heading.textContent.trim();

                // Skip if heading is too short or is a service certification heading
                if (text.length < 2 || text === 'Service Certification') return;

                // Generate ID if it doesn't exist
                let id = heading.id;
                if (!id) {
                    id = generateSlug(text);
                    // Ensure unique ID
                    let uniqueId = id;
                    let counter = 1;
                    while (document.getElementById(uniqueId)) {
                        uniqueId = id + '-' + counter;
                        counter++;
                    }
                    heading.id = uniqueId;
                    id = uniqueId;
                }

                // Create TOC item
                const li = document.createElement('li');
                li.className = 'docs-toc-item';
                li.setAttribute('data-level', level === 'h2' ? '2' : '3');

                const link = document.createElement('a');
                link.className = 'docs-toc-link';
                link.href = '#' + id;
                link.textContent = text;
                link.setAttribute('data-target', id);

                li.appendChild(link);
                tocList.appendChild(li);
                tocItems.push({ id, link, element: heading });
            });

            // Scroll spy functionality
            let activeLink = null;

            function updateActiveLink() {
                let currentId = null;
                const scrollPos = window.scrollY + 100; // Offset for better UX

                // Find the heading closest to the top of viewport
                for (let i = tocItems.length - 1; i >= 0; i--) {
                    const item = tocItems[i];
                    const rect = item.element.getBoundingClientRect();
                    const absoluteTop = rect.top + window.scrollY;

                    if (absoluteTop <= scrollPos) {
                        currentId = item.id;
                        break;
                    }
                }

                // Update active state
                if (currentId && (!activeLink || activeLink.getAttribute('data-target') !== currentId)) {
                    tocItems.forEach(item => {
                        item.link.classList.remove('active');
                    });

                    const newActiveItem = tocItems.find(item => item.id === currentId);
                    if (newActiveItem) {
                        newActiveItem.link.classList.add('active');
                        activeLink = newActiveItem.link;
                    }
                }
            }

            // Throttle scroll events for performance
            let scrollTimeout;
            window.addEventListener('scroll', function() {
                if (scrollTimeout) {
                    window.cancelAnimationFrame(scrollTimeout);
                }
                scrollTimeout = window.requestAnimationFrame(updateActiveLink);
            });

            // Initial update
            updateActiveLink();

            // Smooth scroll on click
            tocList.addEventListener('click', function(e) {
                if (e.target.classList.contains('docs-toc-link')) {
                    e.preventDefault();
                    const targetId = e.target.getAttribute('data-target');
                    const targetElement = document.getElementById(targetId);

                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });

                        // Update URL without jumping
                        history.pushState(null, '', '#' + targetId);
                    }
                }
            });

            // Handle initial hash in URL
            if (window.location.hash) {
                setTimeout(() => {
                    const targetElement = document.querySelector(window.location.hash);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                        updateActiveLink();
                    }
                }, 100);
            }
        })();
    </script>
</body>
</html>